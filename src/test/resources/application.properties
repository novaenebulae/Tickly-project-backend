# ===================================================================
#      FICHIER DE CONFIGURATION EXCLUSIVEMENT POUR LES TESTS
# ===================================================================
# Ce fichier surcharge le fichier principal lors de l'exécution de `./mvnw test`
# On construit l'URL de la base de données en utilisant les variables
# d'environnement fournies par la pipeline GitHub Actions.
spring.datasource.url=jdbc:mysql://${MYSQL_HOST}:${MYSQL_PORT}/${MYSQL_DATABASE_NAME}?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=UTC
# On fournit explicitement les identifiants
spring.datasource.username=${MYSQL_USER}
spring.datasource.password=${MYSQL_ROOT_PASSWORD}
jwt.secret=${JWT_SECRET}
# C'est la ligne la plus importante : on dit à Hibernate de ne pas essayer
# de deviner, et d'utiliser directement le dialecte pour MySQL 8.
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect
# Dit à Hibernate de créer les tables au début des tests et de les supprimer à la fin.
# Cela garantit que chaque test s'exécute sur une base de données propre.
spring.jpa.hibernate.ddl-auto=create-drop
# On active l'initialisation de la base de données pour que les scripts
# comme data.sql (si présents dans src/test/resources) puissent être chargés.
spring.sql.init.mode=always